#!/usr/bin/env bash

# Script for bringing together the results generated by the analyze
# script.
#
# Mathieu Bernard


resfolder=${1:-./results}


header="corpus speaker algo token_f-score token_precision token_recall \
        boundary_f-score boundary_precision boundary_recall"
header=$(echo $header | tr -s ' ' | tr ' ' '\t')
echo $header > $resfolder/results.txt

for algo in $(find $resfolder -name '*cfgold-res.txt' | sort)
do
    corpus=$(echo $algo | cut -d/ -f3)
    ## need to adjust corpus length to align the 1st column
    #len=${#corpus}
    #[ $len -lt 10 ] && add=$(( 10 - $len )) || add=0
    #corpus=$(perl -E "say ' ' x $add")$corpus
    speaker=$(echo $algo | cut -d/ -f4)

    # bring together the results
    adir=$(dirname $algo)
    aname=$(basename $adir | sed 's/3sf/3/' | tr '_' '.')
    line=$(grep '[0-9]' $algo)
    echo $corpus $speaker $aname $line |
        tr -s ' ' | tr ' ' '\t' >> $resfolder/results.txt
done
